!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,s,i=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){a=!0,s=u}finally{try{o||null==n.return||n.return()}finally{if(a)throw s}}return i}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(self.webpackChunknote=self.webpackChunknote||[]).push([[148],{81148:function(t,s,i){"use strict";i.r(s),i.d(s,{RequestAssignmentModule:function(){return I}});var o=i(61116),a=i(49437),u=i(87368),c=i(8361),l=i(77744),p=i(89521),g=i(60649),h=i(50052),d=i(72203),f=i(65916),m=i(28451),q=i(94217),Z=i(49783),v=i(89548);function A(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"button",9),u.NdJ("click",function(){return u.CHM(n),u.oxw().GotoPastWorkers()}),u.ALo(1,"translate"),u.qZA()}2&e&&u.s9C("label",u.lcZ(1,1,"taskCompletedVehicle"))}function y(e,t){1&e&&(u.TgZ(0,"tr",12),u.TgZ(1,"th",13),u._UZ(2,"p-tableHeaderCheckbox"),u.qZA(),u.TgZ(3,"th"),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.TgZ(6,"th"),u._uU(7),u.ALo(8,"translate"),u.qZA(),u.TgZ(9,"th"),u._uU(10),u.ALo(11,"translate"),u.qZA(),u.TgZ(12,"th"),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.TgZ(15,"th"),u._uU(16),u.ALo(17,"translate"),u.qZA(),u.TgZ(18,"th"),u._uU(19),u.ALo(20,"translate"),u.qZA(),u.TgZ(21,"th"),u._uU(22),u.ALo(23,"translate"),u.qZA(),u.TgZ(24,"th"),u._uU(25),u.ALo(26,"translate"),u.qZA(),u.TgZ(27,"th"),u._uU(28),u.ALo(29,"translate"),u.qZA(),u.TgZ(30,"th"),u._uU(31),u.ALo(32,"translate"),u.qZA(),u.qZA()),2&e&&(u.xp6(4),u.Oqu(u.lcZ(5,10,"requester")),u.xp6(3),u.Oqu(u.lcZ(8,12,"reason")),u.xp6(3),u.Oqu(u.lcZ(11,14,"goto")),u.xp6(3),u.Oqu(u.lcZ(14,16,"requestType")),u.xp6(3),u.Oqu(u.lcZ(17,18,"requestTime")),u.xp6(3),u.Oqu(u.lcZ(20,20,"startTime")),u.xp6(3),u.Oqu(u.lcZ(23,22,"endTime")),u.xp6(3),u.Oqu(u.lcZ(26,24,"vehicle")),u.xp6(3),u.Oqu(u.lcZ(29,26,"driver")),u.xp6(3),u.Oqu(u.lcZ(32,28,"action")))}function x(e,t){1&e&&(u.TgZ(0,"tr"),u.TgZ(1,"th",14),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.qZA()),2&e&&(u.xp6(2),u.hij(" ",u.lcZ(3,1,"noActiveAcceptedPoolRequest")," "))}function b(e,t){if(1&e&&(u.YNc(0,y,33,30,"tr",10),u.YNc(1,x,4,3,"tr",11)),2&e){var n=u.oxw();u.Q6J("ngIf",0!=n.requestAssignment.length),u.xp6(1),u.Q6J("ngIf",0==n.requestAssignment.length)}}function S(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.qZA()),2&e){var n=u.oxw().$implicit,r=u.oxw();u.xp6(1),u.AsE(" ",r.supportMethod.getLanguageDate(n.requester.starttime)," ",u.xi3(2,2,n.requester.starttime,"hh:mm:a")," ")}}function T(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(1),u.hij(" ",u.xi3(2,1,n.requester.starttime,"MMM,dd/yyyy")," ")}}function k(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.qZA()),2&e){var n=u.oxw().$implicit,r=u.oxw();u.xp6(1),u.AsE(" ",r.supportMethod.getLanguageDate(n.requester.endtime)," ",u.xi3(2,2,n.requester.endtime,"hh:mm:a")," ")}}function w(e,t){if(1&e&&(u.TgZ(0,"span"),u._uU(1),u.ALo(2,"date"),u.qZA()),2&e){var n=u.oxw().$implicit;u.xp6(1),u.hij(" ",u.xi3(2,1,n.requester.endtime,"MMM,dd/yyyy")," ")}}function U(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"span"),u._UZ(1,"p-menu",17,18),u.TgZ(3,"a",19),u.NdJ("click",function(e){return u.CHM(n),u.MAs(2).toggle(e)}),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit,s=u.oxw();u.xp6(1),u.Q6J("popup",!0)("model",s.managerMenuData(r)),u.xp6(3),u.Oqu(u.lcZ(5,3,"action"))}}function M(e,t){if(1&e){var n=u.EpF();u.TgZ(0,"span"),u._UZ(1,"p-menu",17,18),u.TgZ(3,"a",19),u.NdJ("click",function(e){return u.CHM(n),u.MAs(2).toggle(e)}),u._uU(4),u.ALo(5,"translate"),u.qZA(),u.qZA()}if(2&e){var r=u.oxw().$implicit,s=u.oxw();u.xp6(1),u.Q6J("popup",!0)("model",s.gustMenuData(r)),u.xp6(3),u.Oqu(u.lcZ(5,3,"action"))}}function _(e,t){if(1&e&&(u.TgZ(0,"tr",15),u.TgZ(1,"td"),u._UZ(2,"p-tableCheckbox",16),u.qZA(),u.TgZ(3,"td"),u._uU(4),u._UZ(5,"br"),u._uU(6),u._UZ(7,"br"),u.qZA(),u.TgZ(8,"td"),u._uU(9),u.qZA(),u.TgZ(10,"td"),u._uU(11),u.qZA(),u.TgZ(12,"td"),u._uU(13),u.ALo(14,"translate"),u.qZA(),u.TgZ(15,"td"),u._uU(16),u.qZA(),u.TgZ(17,"td"),u.YNc(18,S,3,5,"span",11),u.YNc(19,T,3,4,"span",11),u.qZA(),u.TgZ(20,"td"),u.YNc(21,k,3,5,"span",11),u.YNc(22,w,3,4,"span",11),u.qZA(),u.TgZ(23,"td"),u._uU(24),u.qZA(),u.TgZ(25,"td"),u._uU(26),u._UZ(27,"br"),u._uU(28),u.qZA(),u.TgZ(29,"td"),u.YNc(30,U,6,5,"span",11),u.YNc(31,M,6,5,"span",11),u.qZA(),u.qZA()),2&e){var n=t.$implicit,r=u.oxw();u.xp6(2),u.Q6J("value",n),u.xp6(2),u.AsE("",n.requester.requester.firstName," ",n.requester.requester.lastName,""),u.xp6(2),u.hij(" ",n.requester.requester.phoneNumber," "),u.xp6(3),u.Oqu(n.requester.reason),u.xp6(2),u.Oqu(n.requester.goto),u.xp6(2),u.Oqu(u.lcZ(14,17,n.requester.requesttype)),u.xp6(3),u.hij(" ",r.supportMethod.getLanguageDate(n.requester.requesteddate)," "),u.xp6(2),u.Q6J("ngIf","indoor"==n.requester.requesttype),u.xp6(1),u.Q6J("ngIf","field"==n.requester.requesttype||"special"==n.requester.requesttype),u.xp6(2),u.Q6J("ngIf","indoor"==n.requester.requesttype),u.xp6(1),u.Q6J("ngIf","field"==n.requester.requesttype||"special"==n.requester.requesttype),u.xp6(2),u.hij(" ",n.vehicles.platenumber," "),u.xp6(2),u.hij("",n.vehicles.driverName," "),u.xp6(2),u.hij(" ",n.vehicles.driverPhone," "),u.xp6(2),u.Q6J("ngIf","FleetManager"==r.userRole||"PoolServiceAdministrator"==r.userRole),u.xp6(1),u.Q6J("ngIf","FleetManager"!=r.userRole&&"PoolServiceAdministrator"!=r.userRole)}}var D,C,L=function(){return{width:"50vw"}},J=[{path:"",component:(D=function(){function t(e,r,s,i,o,a){n(this,t),this.poolService=e,this.sessionService=r,this.supportMethod=s,this.translateService=i,this.routeStateService=o,this.printService=a,this.requestAssignment="",this.iserror=!1,this.responseTitle="",this.responseDialog=!1,this.responseMesssage="",this.responseStyle="",this.SmsContent={requestID:"",phone:"",body:"",status:"0"}}var s,i,o;return s=t,(i=[{key:"ngOnInit",value:function(){this.user=this.sessionService.getItem("currentUser"),this.userRole=this.supportMethod.getUserRole(this.user),this.loading=!1,this.getRequestAssignment()}},{key:"getRequestAssignment",value:function(){var e=this;this.loading=!0,this.poolService.getRequestAssignment().then(function(t){e.requestAssignment="FleetManager"==e.userRole||"PoolServiceAdministrator"==e.userRole?t:t.filter(function(t){return t.requester.requester.department.departmentId==e.user.user.department.departmentId}),e.loading=!1})}},{key:"managerMenuData",value:function(e){var t=this;return this.items=[{label:this.translateService.instant("print"),icon:"pi pi-fw pi-check",command:function(n){t.printData(e)}},{label:this.translateService.instant("sendSms"),command:function(n){t.SendSmsData(e)},icon:"pi pi-fw pi-check"}]}},{key:"gustMenuData",value:function(e){var t=this;return this.items=[{label:this.translateService.instant("print"),icon:"pi pi-fw pi-check",command:function(n){t.printData(e)}},{label:this.translateService.instant("extendTime"),command:function(n){t.SendSmsData(e)},icon:"pi pi-fw pi-check"}]}},{key:"printSelectedData",value:function(){this.printService.generateMultiplePassengerTicketPDF(this.selecteData)}},{key:"printData",value:function(e){this.printService.generateSinglePassengerTicketPDF(e)}},{key:"SendSmsData",value:function(t){return n=this,s=regeneratorRuntime.mark(function n(){var r,s=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return r={requestID:this.user.user.id,phone:"",body:"",status:"0"},this.SmsContent.requestID=this.user.user.id,this.SmsContent.phone=t.requester.requester.phoneNumber,this.SmsContent.body="\u12e8\u1351\u120d \u1325\u12eb\u1244\u12ce \u1270\u1240\u1265\u1208\u1290\u12ce\u1273\u120d \u12e8\u1270\u1218\u12f0\u1260\u12c9".concat(t.vehicles.platenumber," \u1235\u120d\u12ad").concat(t.vehicles.driverPhone," "),r.phone=t.vehicles.driverPhone,r.body="\u12e8\u1351\u120d \u1230\u122d\u126a\u1235 \u12a5\u1295\u12f2\u1230\u1321\u120d\u1295\u1361\u1361 \u12e8\u1270\u1348\u1240\u12f0\u1208\u1275 \u1230\u122b\u1270\u129b ".concat(t.requester.requester.firstName),n.next=8,this.poolService.RegisterSms(this.SmsContent).subscribe(function(e){s.iserror=!1,s.responseStyle="success",s.responseMesssage="Message is sent successfully",s.responseTitle="SUCCESS!!!",s.display=!1},function(t){s.iserror=!0,s.responseTitle="Error!!!",s.responseDialog=!0,s.responseMesssage="",s.display=!1,s.responseStyle="error";for(var n=0,r=Object.entries(t);n<r.length;n++){var i=e(r[n],2),o=(i[0],i[1]);s.responseMesssage=s.responseMesssage+o}});case 8:return n.next=10,this.SendSmsFunction(r);case 10:case"end":return n.stop()}},n,this)}),new((r=void 0)||(r=Promise))(function(e,t){function i(e){try{a(s.next(e))}catch(n){t(n)}}function o(e){try{a(s.throw(e))}catch(n){t(n)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r(function(e){e(n)})).then(i,o)}a((s=s.apply(n,[])).next())});var n,r,s}},{key:"SendSmsFunction",value:function(t){var n=this;this.poolService.RegisterSms(t).subscribe(function(e){n.iserror=!1,n.responseStyle="success",n.responseDialog=!0,n.responseMesssage="Message is sent successfully",n.responseTitle="SUCCESS!!!",n.display=!1},function(t){n.iserror=!0,n.responseTitle="Error!!!",n.responseDialog=!0,n.responseMesssage="",n.display=!1,n.responseStyle="error";for(var r=0,s=Object.entries(t);r<s.length;r++){var i=e(s[r],2),o=(i[0],i[1]);n.responseMesssage=n.responseMesssage+o}})}},{key:"Okonclick",value:function(){this.responseDialog=!1,location.reload()}},{key:"GotoPastWorkers",value:function(){this.routeStateService.add("Dashboard","/main/vehicle/working",null,!0)}}])&&r(s.prototype,i),o&&r(s,o),t}(),D.\u0275fac=function(e){return new(e||D)(u.Y36(c.q),u.Y36(l.m),u.Y36(p.p),u.Y36(g.sK),u.Y36(h.v),u.Y36(d.p))},D.\u0275cmp=u.Xpm({type:D,selectors:[["app-request-assignment"]],decls:16,vars:24,consts:[[3,"visible","modal","visibleChange"],["type","button","pButton","","icon","pi pi-check",3,"label","click"],[2,"text-align","right"],["pButton","","style","margin-right: 10px;","type","button","class","p-button-success",3,"label","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-file-pdf","label","Print",1,"p-button-warning","p-mr-2",3,"disabled","click"],["styleClass","p-datatable-gridlines",3,"value","paginator","rows","autoLayout","loading","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","button",1,"p-button-success",2,"margin-right","10px",3,"label","click"],["class","header-row",4,"ngIf"],[4,"ngIf"],[1,"header-row"],[2,"width","3rem"],["colspan","11",2,"text-align","center","color","red"],[1,"body-row"],[3,"value"],["appendTo","body",3,"popup","model"],["menu",""],[3,"routerLink","click"]],template:function(e,t){1&e&&(u.TgZ(0,"p-dialog",0),u.NdJ("visibleChange",function(e){return t.responseDialog=e}),u.TgZ(1,"p-header"),u.TgZ(2,"p"),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"p"),u._uU(5),u.qZA(),u.TgZ(6,"p-footer"),u.TgZ(7,"button",1),u.NdJ("click",function(){return t.Okonclick()}),u.ALo(8,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(9,"div",2),u.YNc(10,A,2,3,"button",3),u.TgZ(11,"button",4),u.NdJ("click",function(){return t.printSelectedData()}),u.qZA(),u.qZA(),u.TgZ(12,"p-table",5,6),u.NdJ("selectionChange",function(e){return t.selecteData=e}),u.YNc(14,b,2,2,"ng-template",7),u.YNc(15,_,32,19,"ng-template",8),u.qZA()),2&e&&(u.Akn(u.DdM(23,L)),u.Q6J("visible",t.responseDialog)("modal",!0),u.xp6(2),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseTitle," "),u.xp6(1),u.Tol(t.responseStyle),u.xp6(1),u.hij(" ",t.responseMesssage," "),u.xp6(2),u.s9C("label",u.lcZ(8,21,"ok")),u.xp6(3),u.Q6J("ngIf","FleetManager"==t.userRole||"PoolServiceAdministrator"==t.userRole),u.xp6(1),u.Q6J("disabled",!t.selecteData||!t.selecteData.length),u.xp6(1),u.Q6J("value",t.requestAssignment)("paginator",!0)("rows",10)("autoLayout",!0)("loading",t.loading)("selection",t.selecteData))},directives:[f.V,m.h4,m.$_,q.Hq,o.O5,Z.iA,m.jx,Z.Mo,Z.UA,v.v2,a.yS],pipes:[g.X$,o.uU],styles:[""]}),D)}],N=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=u.oAB({type:e}),e.\u0275inj=u.cJS({imports:[[a.Bz.forChild(J)],a.Bz]}),e}(),O=i(35119),I=((C=function e(){n(this,e)}).\u0275fac=function(e){return new(e||C)},C.\u0275mod=u.oAB({type:C}),C.\u0275inj=u.cJS({imports:[[o.ez,N,O.n]]}),C)}}])}();