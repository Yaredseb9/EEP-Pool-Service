(self.webpackChunknote=self.webpackChunknote||[]).push([[148],{81148:function(e,t,s){"use strict";s.r(t),s.d(t,{RequestAssignmentModule:function(){return L}});var i=s(61116),n=s(49437),r=s(87368),o=s(8361),a=s(77744),u=s(89521),l=s(60649),p=s(50052),c=s(72203),h=s(65916),g=s(28451),d=s(94217),q=s(49783),Z=s(89548);function m(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"button",9),r.NdJ("click",function(){return r.CHM(e),r.oxw().GotoPastWorkers()}),r.ALo(1,"translate"),r.qZA()}2&e&&r.s9C("label",r.lcZ(1,1,"taskCompletedVehicle"))}function A(e,t){1&e&&(r.TgZ(0,"tr",12),r.TgZ(1,"th",13),r._UZ(2,"p-tableHeaderCheckbox"),r.qZA(),r.TgZ(3,"th"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"th"),r._uU(7),r.ALo(8,"translate"),r.qZA(),r.TgZ(9,"th"),r._uU(10),r.ALo(11,"translate"),r.qZA(),r.TgZ(12,"th"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"th"),r._uU(16),r.ALo(17,"translate"),r.qZA(),r.TgZ(18,"th"),r._uU(19),r.ALo(20,"translate"),r.qZA(),r.TgZ(21,"th"),r._uU(22),r.ALo(23,"translate"),r.qZA(),r.TgZ(24,"th"),r._uU(25),r.ALo(26,"translate"),r.qZA(),r.TgZ(27,"th"),r._uU(28),r.ALo(29,"translate"),r.qZA(),r.TgZ(30,"th"),r._uU(31),r.ALo(32,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(4),r.Oqu(r.lcZ(5,10,"requester")),r.xp6(3),r.Oqu(r.lcZ(8,12,"reason")),r.xp6(3),r.Oqu(r.lcZ(11,14,"goto")),r.xp6(3),r.Oqu(r.lcZ(14,16,"requestType")),r.xp6(3),r.Oqu(r.lcZ(17,18,"requestTime")),r.xp6(3),r.Oqu(r.lcZ(20,20,"startTime")),r.xp6(3),r.Oqu(r.lcZ(23,22,"endTime")),r.xp6(3),r.Oqu(r.lcZ(26,24,"vehicle")),r.xp6(3),r.Oqu(r.lcZ(29,26,"driver")),r.xp6(3),r.Oqu(r.lcZ(32,28,"action")))}function f(e,t){1&e&&(r.TgZ(0,"tr"),r.TgZ(1,"th",14),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.qZA()),2&e&&(r.xp6(2),r.hij(" ",r.lcZ(3,1,"noActiveAcceptedPoolRequest")," "))}function x(e,t){if(1&e&&(r.YNc(0,A,33,30,"tr",10),r.YNc(1,f,4,3,"tr",11)),2&e){const e=r.oxw();r.Q6J("ngIf",0!=e.requestAssignment.length),r.xp6(1),r.Q6J("ngIf",0==e.requestAssignment.length)}}function T(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"date"),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.AsE(" ",t.supportMethod.getLanguageDate(e.requester.starttime)," ",r.xi3(2,2,e.requester.starttime,"hh:mm:a")," ")}}function S(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"date"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",r.xi3(2,1,e.requester.starttime,"MMM,dd/yyyy")," ")}}function v(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"date"),r.qZA()),2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.AsE(" ",t.supportMethod.getLanguageDate(e.requester.endtime)," ",r.xi3(2,2,e.requester.endtime,"hh:mm:a")," ")}}function b(e,t){if(1&e&&(r.TgZ(0,"span"),r._uU(1),r.ALo(2,"date"),r.qZA()),2&e){const e=r.oxw().$implicit;r.xp6(1),r.hij(" ",r.xi3(2,1,e.requester.endtime,"MMM,dd/yyyy")," ")}}function y(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span"),r._UZ(1,"p-menu",17,18),r.TgZ(3,"a",19),r.NdJ("click",function(t){return r.CHM(e),r.MAs(2).toggle(t)}),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("popup",!0)("model",t.managerMenuData(e)),r.xp6(3),r.Oqu(r.lcZ(5,3,"action"))}}function U(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"span"),r._UZ(1,"p-menu",17,18),r.TgZ(3,"a",19),r.NdJ("click",function(t){return r.CHM(e),r.MAs(2).toggle(t)}),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.qZA()}if(2&e){const e=r.oxw().$implicit,t=r.oxw();r.xp6(1),r.Q6J("popup",!0)("model",t.gustMenuData(e)),r.xp6(3),r.Oqu(r.lcZ(5,3,"action"))}}function M(e,t){if(1&e&&(r.TgZ(0,"tr",15),r.TgZ(1,"td"),r._UZ(2,"p-tableCheckbox",16),r.qZA(),r.TgZ(3,"td"),r._uU(4),r._UZ(5,"br"),r._uU(6),r._UZ(7,"br"),r.qZA(),r.TgZ(8,"td"),r._uU(9),r.qZA(),r.TgZ(10,"td"),r._uU(11),r.qZA(),r.TgZ(12,"td"),r._uU(13),r.ALo(14,"translate"),r.qZA(),r.TgZ(15,"td"),r._uU(16),r.qZA(),r.TgZ(17,"td"),r.YNc(18,T,3,5,"span",11),r.YNc(19,S,3,4,"span",11),r.qZA(),r.TgZ(20,"td"),r.YNc(21,v,3,5,"span",11),r.YNc(22,b,3,4,"span",11),r.qZA(),r.TgZ(23,"td"),r._uU(24),r.qZA(),r.TgZ(25,"td"),r._uU(26),r._UZ(27,"br"),r._uU(28),r.qZA(),r.TgZ(29,"td"),r.YNc(30,y,6,5,"span",11),r.YNc(31,U,6,5,"span",11),r.qZA(),r.qZA()),2&e){const e=t.$implicit,s=r.oxw();r.xp6(2),r.Q6J("value",e),r.xp6(2),r.AsE("",e.requester.requester.firstName," ",e.requester.requester.lastName,""),r.xp6(2),r.hij(" ",e.requester.requester.phoneNumber," "),r.xp6(3),r.Oqu(e.requester.reason),r.xp6(2),r.Oqu(e.requester.goto),r.xp6(2),r.Oqu(r.lcZ(14,17,e.requester.requesttype)),r.xp6(3),r.hij(" ",s.supportMethod.getLanguageDate(e.requester.requesteddate)," "),r.xp6(2),r.Q6J("ngIf","indoor"==e.requester.requesttype),r.xp6(1),r.Q6J("ngIf","field"==e.requester.requesttype||"special"==e.requester.requesttype),r.xp6(2),r.Q6J("ngIf","indoor"==e.requester.requesttype),r.xp6(1),r.Q6J("ngIf","field"==e.requester.requesttype||"special"==e.requester.requesttype),r.xp6(2),r.hij(" ",e.vehicles.platenumber," "),r.xp6(2),r.hij("",e.vehicles.driverName," "),r.xp6(2),r.hij(" ",e.vehicles.driverPhone," "),r.xp6(2),r.Q6J("ngIf","FleetManager"==s.userRole||"PoolServiceAdministrator"==s.userRole),r.xp6(1),r.Q6J("ngIf","FleetManager"!=s.userRole&&"PoolServiceAdministrator"!=s.userRole)}}const _=function(){return{width:"50vw"}},w=[{path:"",component:(()=>{class e{constructor(e,t,s,i,n,r){this.poolService=e,this.sessionService=t,this.supportMethod=s,this.translateService=i,this.routeStateService=n,this.printService=r,this.requestAssignment="",this.iserror=!1,this.responseTitle="",this.responseDialog=!1,this.responseMesssage="",this.responseStyle="",this.SmsContent={requestID:"",phone:"",body:"",status:"0"}}ngOnInit(){this.user=this.sessionService.getItem("currentUser"),this.userRole=this.supportMethod.getUserRole(this.user),this.loading=!1,this.getRequestAssignment()}getRequestAssignment(){this.loading=!0,this.poolService.getRequestAssignment().then(e=>{this.requestAssignment="FleetManager"==this.userRole||"PoolServiceAdministrator"==this.userRole?e:e.filter(e=>e.requester.requester.id==this.user.user.id),this.loading=!1})}managerMenuData(e){return this.items=[{label:this.translateService.instant("print"),icon:"pi pi-fw pi-check",command:t=>{this.printData(e)}},{label:this.translateService.instant("sendSms"),command:t=>{this.SendSmsData(e)},icon:"pi pi-fw pi-check"}]}gustMenuData(e){return this.items=[{label:this.translateService.instant("print"),icon:"pi pi-fw pi-check",command:t=>{this.printData(e)}},{label:this.translateService.instant("extendTime"),command:t=>{this.SendSmsData(e)},icon:"pi pi-fw pi-check"}]}printSelectedData(){this.printService.generateMultiplePassengerTicketPDF(this.selecteData)}printData(e){this.printService.generateSinglePassengerTicketPDF(e)}SendSmsData(e){return t=this,void 0,i=function*(){let t={requestID:this.user.user.id,phone:"",body:"",status:"0"};this.SmsContent.requestID=this.user.user.id,this.SmsContent.phone=e.requester.requester.phoneNumber,this.SmsContent.body=`\u12e8\u1351\u120d \u1325\u12eb\u1244\u12ce \u1270\u1240\u1265\u1208\u1290\u12ce\u1273\u120d \u12e8\u1270\u1218\u12f0\u1260\u12c9${e.vehicles.platenumber} \u1235\u120d\u12ad${e.vehicles.driverPhone} `,t.phone=e.vehicles.driverPhone,t.body=`\u12e8\u1351\u120d \u1230\u122d\u126a\u1235 \u12a5\u1295\u12f2\u1230\u1321\u120d\u1295\u1361\u1361 \u12e8\u1270\u1348\u1240\u12f0\u1208\u1275 \u1230\u122b\u1270\u129b ${e.requester.requester.firstName}`,yield this.poolService.RegisterSms(this.SmsContent).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseMesssage="Message is sent successfully",this.responseTitle="SUCCESS!!!",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s}),yield this.SendSmsFunction(t)},new((s=void 0)||(s=Promise))(function(e,n){function r(e){try{a(i.next(e))}catch(t){n(t)}}function o(e){try{a(i.throw(e))}catch(t){n(t)}}function a(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s(function(e){e(i)})).then(r,o)}a((i=i.apply(t,[])).next())});var t,s,i}SendSmsFunction(e){this.poolService.RegisterSms(e).subscribe(e=>{this.iserror=!1,this.responseStyle="success",this.responseDialog=!0,this.responseMesssage="Message is sent successfully",this.responseTitle="SUCCESS!!!",this.display=!1},e=>{this.iserror=!0,this.responseTitle="Error!!!",this.responseDialog=!0,this.responseMesssage="",this.display=!1,this.responseStyle="error";for(const[t,s]of Object.entries(e))this.responseMesssage=this.responseMesssage+s})}Okonclick(){this.responseDialog=!1,location.reload()}GotoPastWorkers(){this.routeStateService.add("Dashboard","/main/vehicle/working",null,!0)}}return e.\u0275fac=function(t){return new(t||e)(r.Y36(o.q),r.Y36(a.m),r.Y36(u.p),r.Y36(l.sK),r.Y36(p.v),r.Y36(c.p))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-request-assignment"]],decls:16,vars:24,consts:[[3,"visible","modal","visibleChange"],["type","button","pButton","","icon","pi pi-check",3,"label","click"],[2,"text-align","right"],["pButton","","style","margin-right: 10px;","type","button","class","p-button-success",3,"label","click",4,"ngIf"],["pButton","","pRipple","","icon","pi pi-file-pdf","label","Print",1,"p-button-warning","p-mr-2",3,"disabled","click"],["styleClass","p-datatable-gridlines",3,"value","paginator","rows","autoLayout","loading","selection","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pButton","","type","button",1,"p-button-success",2,"margin-right","10px",3,"label","click"],["class","header-row",4,"ngIf"],[4,"ngIf"],[1,"header-row"],[2,"width","3rem"],["colspan","11",2,"text-align","center","color","red"],[1,"body-row"],[3,"value"],["appendTo","body",3,"popup","model"],["menu",""],[3,"routerLink","click"]],template:function(e,t){1&e&&(r.TgZ(0,"p-dialog",0),r.NdJ("visibleChange",function(e){return t.responseDialog=e}),r.TgZ(1,"p-header"),r.TgZ(2,"p"),r._uU(3),r.qZA(),r.qZA(),r.TgZ(4,"p"),r._uU(5),r.qZA(),r.TgZ(6,"p-footer"),r.TgZ(7,"button",1),r.NdJ("click",function(){return t.Okonclick()}),r.ALo(8,"translate"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",2),r.YNc(10,m,2,3,"button",3),r.TgZ(11,"button",4),r.NdJ("click",function(){return t.printSelectedData()}),r.qZA(),r.qZA(),r.TgZ(12,"p-table",5,6),r.NdJ("selectionChange",function(e){return t.selecteData=e}),r.YNc(14,x,2,2,"ng-template",7),r.YNc(15,M,32,19,"ng-template",8),r.qZA()),2&e&&(r.Akn(r.DdM(23,_)),r.Q6J("visible",t.responseDialog)("modal",!0),r.xp6(2),r.Tol(t.responseStyle),r.xp6(1),r.hij(" ",t.responseTitle," "),r.xp6(1),r.Tol(t.responseStyle),r.xp6(1),r.hij(" ",t.responseMesssage," "),r.xp6(2),r.s9C("label",r.lcZ(8,21,"ok")),r.xp6(3),r.Q6J("ngIf","FleetManager"==t.userRole||"PoolServiceAdministrator"==t.userRole),r.xp6(1),r.Q6J("disabled",!t.selecteData||!t.selecteData.length),r.xp6(1),r.Q6J("value",t.requestAssignment)("paginator",!0)("rows",10)("autoLayout",!0)("loading",t.loading)("selection",t.selecteData))},directives:[h.V,g.h4,g.$_,d.Hq,i.O5,q.iA,g.jx,q.Mo,q.UA,Z.v2,n.yS],pipes:[l.X$,i.uU],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[n.Bz.forChild(w)],n.Bz]}),e})();var D=s(35119);let L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.oAB({type:e}),e.\u0275inj=r.cJS({imports:[[i.ez,k,D.n]]}),e})()}}]);